import{d as c,u as l,c as u,a as p,t as d,b as f,e as s,o as h,f as g}from"./index-C3C0ff-O.js";function w(){return"Notification"in window&&navigator.serviceWorker?Notification.requestPermission(function(o){if(console.log("Notification permission status:",o),o==="granted")return navigator.serviceWorker.register("super-push/service-worker.js"),!0}):Promise.reject(!1)}function m(){return navigator.serviceWorker.ready.then(function(o){return o.pushManager.getSubscription().then(function(t){return o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:v("BLPn_QWkclYPp_PQFNIwrFRcxL30uEIGKDTcPWsgZombBV1CRlnz7sqJEOYyJQYoW2BoiIT7Y-r31eZqsEFHU98")}).then(function(r){return r}).catch(function(r){console.log("订阅推送服务失败",r)})})})}function v(o){for(var t="=".repeat((4-o.length%4)%4),r=(o+t).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(r),i=new Uint8Array(n.length),e=0;e<n.length;++e)i[e]=n.charCodeAt(e);return i}const P={class:""},b=c({__name:"home",setup(o){const{userInfo:t}=l(),r=()=>{window.deferredPrompt.prompt()};window.addEventListener("beforeinstallprompt",e=>{console.log("beforeinstallprompt"),window.deferredPrompt=e,console.log(e),e.userChoice.then(a=>{a.outcome==="accepted"?(console.log("addDesktop-pwa用户安装了PWA——可打印---不显示按钮"),pwaIconShow.value=!1):console.log("用户拒绝安装PWA--可打印")})});const n=()=>{window.location.href=`https://github.com/login/oauth/authorize?client_id=Ov23liWi7ycK7kssllDs&redirect_uri=${window.location.href}`},i=()=>{w().then(()=>m()).then(e=>{console.log("3",e),g(e)})};return(e,a)=>(h(),u("div",P,[p(d(f(t))+" ",1),s("div",{class:"login",onClick:n}," 登录 "),s("div",{class:"login",onClick:i}," 获取通知权限 "),s("div",{onClick:r}," 显示弹出 ")]))}});export{b as default};
