import{d as c,u as l,c as u,a as d,t as p,b as f,e as s,o as g,f as h}from"./index-GdU3qJUI.js";function w(){return"Notification"in window&&navigator.serviceWorker?Notification.requestPermission(function(o){if(console.log("Notification permission status:",o),o==="granted")return navigator.serviceWorker.register("/service-worker.js"),!0}):Promise.reject(!1)}function m(){return navigator.serviceWorker.ready.then(function(o){return o.pushManager.getSubscription().then(function(t){return o.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:v("BLPn_QWkclYPp_PQFNIwrFRcxL30uEIGKDTcPWsgZombBV1CRlnz7sqJEOYyJQYoW2BoiIT7Y-r31eZqsEFHU98")}).then(function(n){return n}).catch(function(n){console.log("订阅推送服务失败",n)})})})}function v(o){for(var t="=".repeat((4-o.length%4)%4),n=(o+t).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length),e=0;e<r.length;++e)i[e]=r.charCodeAt(e);return i}const P={class:""},b=c({__name:"home",setup(o){const{userInfo:t}=l(),n=()=>{window.deferredPrompt.prompt()};window.addEventListener("beforeinstallprompt",e=>{console.log("beforeinstallprompt"),window.deferredPrompt=e,console.log(e),e.userChoice.then(a=>{a.outcome==="accepted"?(console.log("addDesktop-pwa用户安装了PWA——可打印---不显示按钮"),pwaIconShow.value=!1):console.log("用户拒绝安装PWA--可打印")})});const r=()=>{window.location.href=`https://github.com/login/oauth/authorize?client_id=Ov23liWi7ycK7kssllDs&redirect_uri=${window.location.origin}`},i=()=>{w().then(()=>m()).then(e=>{console.log("3",e),h(e)})};return(e,a)=>(g(),u("div",P,[d(p(f(t))+" ",1),s("div",{class:"login",onClick:r}," 登录 "),s("div",{class:"login",onClick:i}," 获取通知权限 "),s("div",{onClick:n}," 显示弹出 ")]))}});export{b as default};
